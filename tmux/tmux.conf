# ==========================================================
#  Configuración Inicial para Tmux
# ==========================================================

# --- Comportamiento General ---

# Cambiar la combinación de prefijo de Ctrl-b a Ctrl-a (más accesible)
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Habilitar el uso del ratón (seleccionar paneles, ventanas, redimensionar)
set -g mouse on

# Habilitar colores de 24-bit (True Color) para que Neovim se vea perfecto
set -g default-terminal "tmux-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"

# Empezar a contar ventanas y paneles desde 1 en lugar de 0
set -g base-index 1
setw -g pane-base-index 1
set-option -g renumber-windows on

# Aumentar el historial de scroll
set -g history-limit 10000


# --- Atajos de Teclado (Keybinds) ---

# Recargar la configuración rápidamente con Prefijo + r
bind r source-file ~/.tmux.conf \; display "Configuración recargada!"

# Dividir paneles con atajos más intuitivos
bind | split-window -h -c "#{pane_current_path}" # División vertical
bind - split-window -v -c "#{pane_current_path}" # División horizontal
unbind '"'
unbind %

# Cambiar entre paneles con Alt + Flechas (sin necesidad del prefijo)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D


# --- Integración con Neovim (vim-tmux-navigator) ---
# Esto es esencial para usar Ctrl + h/j/k/l para moverte entre Neovim y tmux

is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'

bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R


# --- Apariencia de la Barra de Estado (Tema Catppuccin Mocha) ---

# --- Paleta de Colores (Catppuccin Mocha) ---
# Definimos los colores para usarlos fácilmente
color_bg="0x1e1e2e" # Fondo
color_fg="0xcdd6f4" # Texto
color_inactive_bg="0x45475a"
color_active_bg="0x89b4fa"
color_active_fg="0x1e1e2e"
color_dark_gray="0x313244"

# --- Configuración General de la Barra ---
set -g status-position top
set -g status "on"
set -g status-interval 1
set -g status-justify "left"
set -g status-style "fg=$color_fg,bg=$color_bg"

# --- Lado Izquierdo (Sesión) ---
set -g status-left-length 100
set -g status-left "#[fg=$color_active_fg,bg=$color_active_bg,bold]  सेशन #S #[fg=$color_active_bg,bg=$color_bg,nobold,nounderscore,noitalics]"

# --- Lado Derecho (Info del Sistema) ---
set -g status-right-length 100
set -g status-right "#[fg=$color_dark_gray,bg=$color_bg,nobold,nounderscore,noitalics]#[fg=$color_fg,bg=$color_dark_gray] %d-%m-%Y  %H:%M #[fg=$color_active_bg,bg=$color_dark_gray,nobold,nounderscore,noitalics]#[fg=$color_active_fg,bg=$color_active_bg,bold] #(whoami) "

# --- Ventanas (Centro) ---
setw -g window-status-separator ""
setw -g window-status-style "fg=$color_fg,bg=$color_bg"

# Formato de la Ventana Inactiva
setw -g window-status-format "#[fg=$color_fg,bg=$color_inactive_bg,nobold,nounderscore,noitalics]#[fg=$color_fg,bg=$color_inactive_bg] #I  #W #[fg=$color_inactive_bg,bg=$color_bg,nobold,nounderscore,noitalics]"

# Formato de la Ventana Activa
setw -g window-status-current-format "#[fg=$color_inactive_bg,bg=$color_active_bg,nobold,nounderscore,noitalics]#[fg=$color_active_fg,bg=$color_active_bg,bold] #I  #W #[fg=$color_active_bg,bg=$color_inactive_bg,nobold,nounderscore,noitalics]"

